2026-02-20 07:17:52,350 | INFO | Run dir: /home/thalles.fontainha/2026-2/results/EX3/20260220-071752
2026-02-20 07:17:52,350 | INFO | Device: cuda
2026-02-20 07:17:52,350 | INFO | CUDA available: True
2026-02-20 07:17:52,372 | INFO | CUDA device_count: 2
2026-02-20 07:17:52,380 | INFO | GPU 0: NVIDIA GeForce RTX 2080 Ti
2026-02-20 07:17:52,380 | INFO | GPU 1: NVIDIA GeForce RTX 2080 Ti
2026-02-20 07:17:52,380 | INFO | Config multi_gpu=True | gpu_ids=(0, 1) | batch_size=32 | num_workers=4
2026-02-20 07:17:52,380 | INFO | Etapa: copiando snapshot do código (.py) para auditoria...
2026-02-20 07:17:52,407 | INFO | Snapshot concluído em 0.0min
2026-02-20 07:17:52,407 | INFO | Etapa: carregando dataset base (sem transforms)...
2026-02-20 07:18:25,644 | INFO | Dataset carregado em 0.6min | N=2976 | pos=1317 neg=1659
2026-02-20 07:18:25,657 | INFO | Etapa: construindo preprocess (CPU) + augmentation_fn (GPU, só treino)...
2026-02-20 07:18:25,657 | INFO | Preprocess/aug_fn prontos em 0.0min | aug_profile=baseline | augmentation=True
2026-02-20 07:18:25,657 | INFO | Etapa: gerando outer folds (n_splits=5)...
2026-02-20 07:18:25,658 | INFO | Outer folds prontos em 0.0min
2026-02-20 07:18:25,659 | INFO | Fold 1/5 | outer_train=2380 outer_test=596
2026-02-20 07:18:25,660 | INFO | Fold 1: etapa inner split (inner_val_frac=0.15)...
2026-02-20 07:18:25,662 | INFO | Fold 1: inner split concluído em 0.0min | inner_train=2023 inner_val=357
2026-02-20 07:18:25,662 | INFO | Fold 1: etapa oversampling (treino) | enabled=False...
2026-02-20 07:18:25,662 | INFO | Fold 1: oversampling concluído em 0.0min | inner_train_os=2023
2026-02-20 07:18:25,662 | INFO | Fold 1: etapa criando DataLoaders (train/inner_val/outer_test)...
2026-02-20 07:18:25,662 | INFO | Fold 1: DataLoaders prontos em 0.0min
2026-02-20 07:18:25,662 | INFO | Fold 1: treino inner (early stopping) | pretrained=True amp=False multi_gpu=True gpu_ids=(0, 1)
Traceback (most recent call last):
  File "/home/thalles.fontainha/2026-2/EX3.py", line 28, in <module>
    result = run_experiment(cfg, project_root=Path(__file__).resolve().parent)
  File "/home/thalles.fontainha/2026-2/oai3d/runner.py", line 251, in run_experiment
    inner_info = fit_inner_earlystop(
  File "/home/thalles.fontainha/2026-2/oai3d/train.py", line 258, in fit_inner_earlystop
    tr_loss, tr_metrics = train_epoch(
  File "/home/thalles.fontainha/2026-2/oai3d/train.py", line 149, in train_epoch
    logits = model(x).view(-1)  # (N,)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 171, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 181, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/parallel/parallel_apply.py", line 89, in parallel_apply
    output.reraise()
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
torch.cuda.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/parallel/parallel_apply.py", line 64, in _worker
    output = module(*input, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/2026-2/oai3d/model.py", line 74, in forward
    return self.backbone(x).squeeze(1)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torchvision/models/video/resnet.py", line 254, in forward
    x = self.layer2(x)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torchvision/models/video/resnet.py", line 112, in forward
    out = self.conv1(x)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 613, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/thalles.fontainha/jupyter_env_310/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 608, in _conv_forward
    return F.conv3d(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 256.00 MiB (GPU 0; 10.57 GiB total capacity; 10.25 GiB already allocated; 42.75 MiB free; 10.26 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

